<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style type="text/css">
        * {
            margin: 0;
            padding: 0;
        }
    </style>
</head>
<body>
<div id="chart-area"></div>
<script src="js/d3.v6.min.js"></script>
<script src="js/lodash.min.js"></script>
<script type="text/javascript">

    const MARGIN = {LEFT: 60, TOP: 20, RIGHT: 10, BOTTOM: 100}
    const WIDTH = 600 - MARGIN.LEFT - MARGIN.RIGHT;
    const HEIGHT = 400 - MARGIN.TOP - MARGIN.BOTTOM

    const svg = d3.select('#chart-area').append('svg')
    .attr('width', WIDTH + MARGIN.LEFT + MARGIN.RIGHT)
    .attr('height', HEIGHT + MARGIN.TOP + MARGIN.BOTTOM)
    .style('background-color', '#e8e8e8')

    const g = svg.append('g').attr('transform', `translate(${MARGIN.LEFT}, ${MARGIN.TOP})`)


    const data = []
    for(let i = 1; i <= 12; i++) {
        data.push({month: `thÃ¡ng ${i}`, data: _.random(0, 350)},)
    }
    console.log('data', data)


    const rects = g.selectAll('rect').data(data);

    const months = _.map(data, 'month');
    const colors = d3.scaleOrdinal().domain(months).range(d3.schemeCategory10);
    const x = d3.scaleBand().domain(months)
        .range([0, WIDTH])
        .paddingInner(0.1)
        .paddingOuter(0.1);

    const y = d3.scaleLinear().domain([0, d3.max(_.map(data, 'data'))]).range([0, HEIGHT])


    const xAxisCall = d3.axisBottom(x)
    const yAxisCall = d3.axisLeft(y).ticks(5).tickFormat(d => `${d}m`)

    g.append('g').attr('class', 'left-axis')
        .call(yAxisCall)

    g.append('g').attr('class', 'buttom-axis')
        .attr('transform', `translate(0, ${HEIGHT})`)
        .call(xAxisCall)
        .selectAll('text')
        .attr('y', 10)
        .attr('x', -5)
        .attr('text-anchor', 'end')
        .attr('transform', 'rotate(-40)')



    rects.enter().append('rect')
    .attr('x', d => {
        console.log('x', x(d.month))
        return x(d.month)
    })
    .attr('y', 0)
    .attr('width', x.bandwidth())
    .attr('height', d => {
        console.log('y', y(d.data))
        return y(d.data)
    })
    .attr('fill', d => colors(d.month))

</script>
</body>
</html>
